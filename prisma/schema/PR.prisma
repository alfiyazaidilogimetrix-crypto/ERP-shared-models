enum PRStatus {
    DRAFT
    SUBMITTED
    APPROVED
    REJECTED
    CLOSED
}

enum UrgencyLevel {
    LOW
    MEDIUM
    HIGH
    CRITICAL
}

model PR {
    id         Int    @id @default(autoincrement())
    project_id Int
    pr_code    String @unique

    urgency_level UrgencyLevel
    status        PRStatus     @default(DRAFT)

    remarks String?

    user_id     Int? // Created by
    approved_by Int? // Approver (User ID)

    user User? @relation("CreatedBy", fields: [user_id], references: [id])

    material_items PRMaterialItem[]
    project        Project          @relation(fields: [project_id], references: [id])
    created_at     DateTime         @default(now())
    updated_at     DateTime         @updatedAt
    pos            PO[]
    approvedUser   User?            @relation("ApprovedBy", fields: [approved_by], references: [id])

    @@index([project_id])
    @@index([user_id])
}

model PRMaterialItem {
    id    Int @id @default(autoincrement())
    pr_id Int

    material_id   Int
    quantity      String
    required_date DateTime

    pr       PR       @relation(fields: [pr_id], references: [id], onDelete: Cascade)
    material Material @relation(fields: [material_id], references: [id])

    created_at DateTime @default(now())
}
